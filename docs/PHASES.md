# Danilarious OS + Canvas — Phases and Working MethodThis document is the execution roadmap. It exists so a new agent (or a new session) can reliably pick “the next phase” without improvising architecture or skipping fundamentals.## How to Run a Session1) **Start**- Read the last 1–3 entries in `CHANGELOG.md`.- Read the relevant phase section in `docs/PHASES.md`.- Summarize current state + confirm the scope of THIS session.2) **Implement**- Stay inside the current phase scope.- Prefer small, reversible changes.- Avoid feature creep.3) **Verify locally**- `npm run dev` and test the specific behaviors targeted in this session.- If relevant, `npm run build` to confirm production build.4) **Close out**- Append a new entry to `CHANGELOG.md`:  - what changed (file-level + behavior)  - decisions/tradeoffs  - open questions / TODO  - one recommended next step5) **Ship (human step)**- Once validated locally:  - `git add .`  - `git commit -m "..."` (clear message)  - `git push`- Netlify updates from the pushed branch.---## Phase 0 — Foundations (Complete)**Definition of done**- Canvas runs as a desktop mode.- Render behavior is documented in `docs/RENDER-CONTRACT.md`.- Build passes consistently.- CHANGELOG process is working.---## Phase 1 — Interaction Correctness (Current Priority)**Goal**Canvas feels correct and predictable before UI polish or backend work.**Must-have outcomes**- New shapes spawn at the center of the current viewport (not 0,0).- No auto-inserted demo shape unless explicitly enabled.- Single-gesture placement: no double-click required to “drop” a shape.- Selection/transform works while UI is visible (no “hide panels to use it” workaround).- Undo works (`Cmd+Z`) for at least: add element, move, rotate, scale.- Snap-to-grid overlay is either:  - perfectly aligned with the OS grid, or  - disabled while snap-only behavior remains predictable.**Nice-to-have**- Scaling does not scale stroke width.**Non-goals (defer)**- Backend/admin upload- Kaleidoscope correctness overhaul- Docking, collapsible window systems**Exit criteria**You can place, move, rotate, scale, and undo with confidence in a normal workflow.---## Phase 2 — UI Architecture: Windows, Tool Rail, and Layout**Goal**Match the intended “OS + creative tool” experience.**Must-have outcomes**- Left tool rail is fixed (tools + parametric shape flyout).- Explorer is a floating, draggable window.- Effects is a floating, draggable window.- Windows can be shown/hidden without losing canvas state.- “Exit Canvas” returns to desktop without destroying work.**Nice-to-have**- Collapsible windows.- Docking behaviors (down the line).**Non-goals**- Perfect styling- Complex window snapping/docking logic**Exit criteria**The UI maps cleanly to the mockup and feels like a coherent tool.---## Phase 3 — Export Truth: Preview Matches Output**Goal**What the user sees (in isolate) matches what exports, deterministically.**Must-have outcomes**- Decide export compositing:  - Konva only, or  - bake WebGL mirror, or  - bake CSS overlay replacement- Implement export so isolate view equals exported PNG.- No CSS-only effects that cannot be captured deterministically.**Exit criteria**Export is trustworthy and repeatable.---## Phase 4 — Asset Ingestion: Admin Upload + Manifest API**Goal**Safely feed the tool with custom SVG packs.**Must-have outcomes**- Upload SVG → sanitize → store → manifest entry.- Explorer pulls from manifest API (not a hardcoded JSON file).- Asset metadata supports the render contract (viewBox, intrinsic size, pivot policy).**Exit criteria**You can upload new assets and use them immediately in Canvas.---## Phase 5 — Kaleidoscope and Motion (GIF-forward)**Goal**Make kaleidoscope correct, compelling, and compatible with future GIF export.**Must-have outcomes**- Lens/slice model:  - slices, zoom (lens size), rotation, cycle speed- Cycle toggle gates speed.- Mirror sampling is accurate; no “original canvas underneath” leakage.- Animation clock supports frame stepping (future GIF).**Exit criteria**Kaleidoscope feels intentional and export-safe.---## Phase 6 — Shipping Polish**Goal**Quality, performance, and usability.Potential items:- Code splitting / performance warnings- Mobile/touch tuning- Presets- Shareable links (optional)- GIF export